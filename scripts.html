<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.1 from src/site/markdown/scripts.md at 2022-08-19
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.1" />
    <title>Java RPM builder &#x2013; Scripts</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>Java RPM builder</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2022-08-19<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.9.0</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="plugin-info.html" title="Goals"><span class="none"></span>Goals</a></li>
    <li><a href="usage.html" title="Usage"><span class="none"></span>Usage</a></li>
    <li><a href="example-primary.html" title="Example (primary artifact)"><span class="none"></span>Example (primary artifact)</a></li>
    <li><a href="example.html" title="Example (secondary artifact)"><span class="none"></span>Example (secondary artifact)</a></li>
   <li class="nav-header">Configuration</li>
    <li><a href="entry.html" title="Payload Entries"><span class="none"></span>Payload Entries</a></li>
    <li><a href="rulesets.html" title="Rulesets"><span class="none"></span>Rulesets</a></li>
    <li><a href="payload_information.html" title="Payload information"><span class="none"></span>Payload information</a></li>
    <li class="active"><a href="#"><span class="none"></span>Scripts</a></li>
    <li><a href="deps.html" title="Dependencies"><span class="none"></span>Dependencies</a></li>
    <li><a href="signing.html" title="Signing"><span class="none"></span>Signing</a></li>
    <li><a href="naming.html" title="Naming"><span class="none"></span>Naming</a></li>
    <li><a href="lead.html" title="Lead information"><span class="none"></span>Lead information</a></li>
    <li><a href="verify.html" title="Verification flags"><span class="none"></span>Verification flags</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
    <div id="twitter">
    <a href="https://twitter.com/ctron" class="twitter-follow-button" data-show-count="false" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow ctron</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Scripts</h1>
<p>RPM allows to run scripts at various points.</p>
<p>Also see * <a class="externalLink" href="https://fedoraproject.org/wiki/Packaging:Scriptlets">https://fedoraproject.org/wiki/Packaging:Scriptlets</a> * <a class="externalLink" href="http://www.rpm.org/max-rpm/s1-rpm-specref-scripts.html#S2-RPM-SPECREF-INSTALL-ERASE-SCRIPTS">http://www.rpm.org/max-rpm/s1-rpm-specref-scripts.html#S2-RPM-SPECREF-INSTALL-ERASE-SCRIPTS</a></p><section>
<h2><a name="Script_types"></a>Script types</h2>
<p>The RPM builder current does support the following script types of RPM:</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> Type </th>
<th> Tag </th>
<th> Spec Name </th>
<th> Description </th></tr>
</thead><tbody>

<tr class="b">
<td> Before Transaction </td>
<td> &lt;beforeTransaction&gt; </td>
<td> %pretrans </td>
<td> Run before the transaction </td></tr>
<tr class="a">
<td> Before Installation </td>
<td> &lt;beforeInstallation&gt; </td>
<td> %pre </td>
<td> Run before the installation of the package </td></tr>
<tr class="b">
<td> After Installation </td>
<td> &lt;afterInstallation&gt; </td>
<td> %post </td>
<td> Run after the installation of the package </td></tr>
<tr class="a">
<td> Before Removal </td>
<td> &lt;beforeRemoval&gt; </td>
<td> %preun </td>
<td> Run before the removal of the package </td></tr>
<tr class="b">
<td> After Removal </td>
<td> &lt;afterRemoval&gt; </td>
<td> %postun </td>
<td> Run after the removal of the package </td></tr>
<tr class="a">
<td> After Transaction </td>
<td> &lt;afterTransaction&gt; </td>
<td> %posttrans </td>
<td> Run after the transaction </td></tr>
</tbody>
</table>
<p>Please note that RPM has a few things you might not expected from your scripts. For example is it possible to have multiple RPMs with the same package name, but different versions, installed. This will still call your &#x201c;After removal&#x201d; script, even when there is still one or more other versions of your package left. Please consult the RPM documentation for more information about scripts.</p>
<p>There are also a couple triggers, which are currently not supported by the RPM builder.</p>
<p>**Note: ** In the following examples &lt;script&gt; will be used to represent any script type.</p></section><section>
<h2><a name="Basic_configuration"></a>Basic configuration</h2>
<p>Scripts are configured using the normal plugin configuration:</p>

<div>
<div>
<pre class="source">&lt;configuration&gt;
  &#x2026;
    &lt;beforeInstallation&gt;&#x2026;&lt;/beforeInstallation&gt;
    &#x2026;
    &lt;defaultInterpreter&gt;&#x2026;&lt;/defaultInterpreter&gt; &lt;!-- optional --&gt;
  &#x2026;
&lt;/configuration&gt;
</pre></div></div>

<p>All scripts share the same configuration:</p>

<div>
<div>
<pre class="source">&lt;script&gt;
   &lt;interpreter&gt;/bin/bash&lt;/interpreter&gt; &lt;!-- optional interpreter --&gt;
   
   &lt;!-- either one of the following --&gt;
   &lt;script&gt;echo &quot;foo bar&quot;&lt;/script&gt; &lt;!-- direct script content --&gt;
   &lt;file&gt;src/main/resources/someScript.sh&lt;/file&gt; &lt;!-- script content from file --&gt;
&lt;/script&gt;
</pre></div></div>

<p>It is also possible to use a quicker variant with inline script content:</p>

<div>
<div>
<pre class="source">&lt;script&gt;
   echo &quot;foo bar&quot;
&lt;/script&gt;
</pre></div></div>

<p>Scripts can either be provided as plain text from inside the Maven configuration or can be read from a file. Specifying both elements (&lt;script&gt; and &lt;file&gt;) is unsupported.</p>
<p>The &lt;interpreter&gt; elements specifies the script interpreter to use. If it is left out, then the RPM builder will peek into the first line of the script in try to evaluate the script from the #! marker. (#!/bin/bash will result in /bin/bash).</p>
<p>The &lt;beforeTransaction&gt; element can not have have dependencies and so must be written in Lua to avoid issues with kickstarting a system.  RPM builder will not verify or ensure this and uses its above logic to determine the interpreter, so be sure to specify it.</p>
<p>If this fails, then the value of the &lt;defaultInterpreter&gt; element from the main configuration is used, which defaults to /bin/sh.</p></section><section>
<h2><a name="Remarks"></a>Remarks</h2>
<p>The RPM builder currently does not support triggers.</p>
<p>If using inline scripts, then the XML formatting might add a few extra whitespaces to your inline script content. Depending on the script language this may be problem. It is possible to use the &lt;![CDATA[&#x2026;]]&gt; element to work around this. Alternatively you can also use the external file mechanism. However due to the fact that the RPM builder does not know about the different script languages it does not trim, strip or clean up scripts in any way.</p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &#169;      2016&#x2013;2022..</p>
        </div>
      </div>
    </footer>
  </body>
</html>
